
node {
  def remote = [:]
  remote.name = 'k8s-master'
  remote.host = '192.168.0.26'
  remote.user = 'root'
  remote.password = 'password'
  remote.allowAnyHosts = true
  stage('Clone GitHub repo to K8s cluster') {
    sshCommand remote: remote, command: " git clone https://github.com/Iyadomry/app2.git /root/app2 "
    sshCommand remote: remote, command: " cd /root/app2"
  }  
  stage('Build Docker Image from Dockerfile') {
    sshCommand remote: remote, command: " docker build -t app2:v1 /root/app2/."
  }
  stage('Delete the Repo') {
    sshCommand remote: remote, command: " rm -rf app2/ "
  }
}
